{"ast":null,"code":"\"use strict\";\n\nexports.__esModule = true;\nexports[\"default\"] = initializeBuildWatcher;\nvar _eventsource = require(\"./error-overlay/eventsource\");\nfunction initializeBuildWatcher(toggleCallback) {\n  var shadowHost = document.createElement('div');\n  shadowHost.id = '__next-build-watcher'; // Make sure container is fixed and on a high zIndex so it shows\n  shadowHost.style.position = 'fixed';\n  shadowHost.style.bottom = '10px';\n  shadowHost.style.right = '20px';\n  shadowHost.style.width = 0;\n  shadowHost.style.height = 0;\n  shadowHost.style.zIndex = 99999;\n  document.body.appendChild(shadowHost);\n  var shadowRoot;\n  var prefix = '';\n  if (shadowHost.attachShadow) {\n    shadowRoot = shadowHost.attachShadow({\n      mode: 'open'\n    });\n  } else {\n    // If attachShadow is undefined then the browser does not support\n    // the Shadow DOM, we need to prefix all the names so there\n    // will be no conflicts\n    shadowRoot = shadowHost;\n    prefix = '__next-build-watcher-';\n  } // Container\n  var container = createContainer(prefix);\n  shadowRoot.appendChild(container); // CSS\n  var css = createCss(prefix);\n  shadowRoot.appendChild(css); // State\n  var isVisible = false;\n  var isBuilding = false;\n  var timeoutId = null; // Handle events\n  var evtSource = (0, _eventsource.getEventSourceWrapper)({\n    path: '/_next/webpack-hmr'\n  });\n  evtSource.addMessageListener(function (event) {\n    // This is the heartbeat event\n    if (event.data === \"\\uD83D\\uDC93\") {\n      return;\n    }\n    try {\n      handleMessage(event);\n    } catch (_unused) {}\n  });\n  function handleMessage(event) {\n    var obj = typeof event === 'string' ? {\n      action: event\n    } : JSON.parse(event.data); // eslint-disable-next-line default-case\n    switch (obj.action) {\n      case 'building':\n        timeoutId && clearTimeout(timeoutId);\n        isVisible = true;\n        isBuilding = true;\n        updateContainer();\n        break;\n      case 'built':\n      case 'sync':\n        isBuilding = false; // Wait for the fade out transtion to complete\n        timeoutId = setTimeout(function () {\n          isVisible = false;\n          updateContainer();\n        }, 100);\n        updateContainer();\n        break;\n    }\n  }\n  toggleCallback(handleMessage);\n  function updateContainer() {\n    if (isBuilding) {\n      container.classList.add(\"\".concat(prefix, \"building\"));\n    } else {\n      container.classList.remove(\"\".concat(prefix, \"building\"));\n    }\n    if (isVisible) {\n      container.classList.add(\"\".concat(prefix, \"visible\"));\n    } else {\n      container.classList.remove(\"\".concat(prefix, \"visible\"));\n    }\n  }\n}\nfunction createContainer(prefix) {\n  var container = document.createElement('div');\n  container.id = \"\".concat(prefix, \"container\");\n  container.innerHTML = \"\\n    <div id=\\\"\".concat(prefix, \"icon-wrapper\\\">\\n      <svg viewBox=\\\"0 0 226 200\\\">\\n        <defs>\\n          <linearGradient\\n            x1=\\\"114.720775%\\\"\\n            y1=\\\"181.283245%\\\"\\n            x2=\\\"39.5399306%\\\"\\n            y2=\\\"100%\\\"\\n            id=\\\"\").concat(prefix, \"linear-gradient\\\"\\n          >\\n            <stop stop-color=\\\"#000000\\\" offset=\\\"0%\\\" />\\n            <stop stop-color=\\\"#FFFFFF\\\" offset=\\\"100%\\\" />\\n          </linearGradient>\\n        </defs>\\n        <g id=\\\"\").concat(prefix, \"icon-group\\\" fill=\\\"none\\\" stroke=\\\"url(#\").concat(prefix, \"linear-gradient)\\\" stroke-width=\\\"18\\\">\\n          <path d=\\\"M113,5.08219117 L4.28393801,197.5 L221.716062,197.5 L113,5.08219117 Z\\\" />\\n        </g>\\n      </svg>\\n    </div>\\n  \");\n  return container;\n}\nfunction createCss(prefix) {\n  var css = document.createElement('style');\n  css.textContent = \"\\n    #\".concat(prefix, \"container {\\n      position: absolute;\\n      bottom: 10px;\\n      right: 30px;\\n\\n      border-radius: 3px;\\n      background: #000;\\n      color: #fff;\\n      font: initial;\\n      cursor: initial;\\n      letter-spacing: initial;\\n      text-shadow: initial;\\n      text-transform: initial;\\n      visibility: initial;\\n\\n      padding: 7px 10px 8px 10px;\\n      align-items: center;\\n      box-shadow: 0 11px 40px 0 rgba(0, 0, 0, 0.25), 0 2px 10px 0 rgba(0, 0, 0, 0.12);\\n\\n      display: none;\\n      opacity: 0;\\n      transition: opacity 0.1s ease, bottom 0.1s ease;\\n      animation: \").concat(prefix, \"fade-in 0.1s ease-in-out;\\n    }\\n\\n    #\").concat(prefix, \"container.\").concat(prefix, \"visible {\\n      display: flex;\\n    }\\n\\n    #\").concat(prefix, \"container.\").concat(prefix, \"building {\\n      bottom: 20px;\\n      opacity: 1;\\n    }\\n\\n    #\").concat(prefix, \"icon-wrapper {\\n      width: 16px;\\n      height: 16px;\\n    }\\n\\n    #\").concat(prefix, \"icon-wrapper > svg {\\n      width: 100%;\\n      height: 100%;\\n    }\\n\\n    #\").concat(prefix, \"icon-group {\\n      animation: \").concat(prefix, \"strokedash 1s ease-in-out both infinite;\\n    }\\n\\n    @keyframes \").concat(prefix, \"fade-in {\\n      from {\\n        bottom: 10px;\\n        opacity: 0;\\n      }\\n      to {\\n        bottom: 20px;\\n        opacity: 1;\\n      }\\n    }\\n\\n    @keyframes \").concat(prefix, \"strokedash {\\n      0% {\\n        stroke-dasharray: 0 226;\\n      }\\n      80%,\\n      100% {\\n        stroke-dasharray: 659 226;\\n      }\\n    }\\n  \");\n  return css;\n}","map":{"version":3,"sources":["../../../client/dev/dev-build-watcher.js"],"names":["initializeBuildWatcher","toggleCallback","shadowHost","document","createElement","id","style","position","bottom","right","width","height","zIndex","body","appendChild","shadowRoot","prefix","attachShadow","mode","container","createContainer","css","createCss","isVisible","isBuilding","timeoutId","evtSource","path","addMessageListener","event","data","handleMessage","obj","action","JSON","parse","clearTimeout","updateContainer","setTimeout","classList","add","remove","innerHTML","textContent"],"mappings":"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","sourcesContent":["import { getEventSourceWrapper } from './error-overlay/eventsource'\n\nexport default function initializeBuildWatcher(toggleCallback) {\n  const shadowHost = document.createElement('div')\n  shadowHost.id = '__next-build-watcher'\n  // Make sure container is fixed and on a high zIndex so it shows\n  shadowHost.style.position = 'fixed'\n  shadowHost.style.bottom = '10px'\n  shadowHost.style.right = '20px'\n  shadowHost.style.width = 0\n  shadowHost.style.height = 0\n  shadowHost.style.zIndex = 99999\n  document.body.appendChild(shadowHost)\n\n  let shadowRoot\n  let prefix = ''\n\n  if (shadowHost.attachShadow) {\n    shadowRoot = shadowHost.attachShadow({ mode: 'open' })\n  } else {\n    // If attachShadow is undefined then the browser does not support\n    // the Shadow DOM, we need to prefix all the names so there\n    // will be no conflicts\n    shadowRoot = shadowHost\n    prefix = '__next-build-watcher-'\n  }\n\n  // Container\n  const container = createContainer(prefix)\n  shadowRoot.appendChild(container)\n\n  // CSS\n  const css = createCss(prefix)\n  shadowRoot.appendChild(css)\n\n  // State\n  let isVisible = false\n  let isBuilding = false\n  let timeoutId = null\n\n  // Handle events\n  const evtSource = getEventSourceWrapper({ path: '/_next/webpack-hmr' })\n  evtSource.addMessageListener((event) => {\n    // This is the heartbeat event\n    if (event.data === '\\uD83D\\uDC93') {\n      return\n    }\n\n    try {\n      handleMessage(event)\n    } catch {}\n  })\n\n  function handleMessage(event) {\n    const obj =\n      typeof event === 'string' ? { action: event } : JSON.parse(event.data)\n\n    // eslint-disable-next-line default-case\n    switch (obj.action) {\n      case 'building':\n        timeoutId && clearTimeout(timeoutId)\n        isVisible = true\n        isBuilding = true\n        updateContainer()\n        break\n      case 'built':\n      case 'sync':\n        isBuilding = false\n        // Wait for the fade out transtion to complete\n        timeoutId = setTimeout(() => {\n          isVisible = false\n          updateContainer()\n        }, 100)\n        updateContainer()\n        break\n    }\n  }\n\n  toggleCallback(handleMessage)\n\n  function updateContainer() {\n    if (isBuilding) {\n      container.classList.add(`${prefix}building`)\n    } else {\n      container.classList.remove(`${prefix}building`)\n    }\n\n    if (isVisible) {\n      container.classList.add(`${prefix}visible`)\n    } else {\n      container.classList.remove(`${prefix}visible`)\n    }\n  }\n}\n\nfunction createContainer(prefix) {\n  const container = document.createElement('div')\n  container.id = `${prefix}container`\n  container.innerHTML = `\n    <div id=\"${prefix}icon-wrapper\">\n      <svg viewBox=\"0 0 226 200\">\n        <defs>\n          <linearGradient\n            x1=\"114.720775%\"\n            y1=\"181.283245%\"\n            x2=\"39.5399306%\"\n            y2=\"100%\"\n            id=\"${prefix}linear-gradient\"\n          >\n            <stop stop-color=\"#000000\" offset=\"0%\" />\n            <stop stop-color=\"#FFFFFF\" offset=\"100%\" />\n          </linearGradient>\n        </defs>\n        <g id=\"${prefix}icon-group\" fill=\"none\" stroke=\"url(#${prefix}linear-gradient)\" stroke-width=\"18\">\n          <path d=\"M113,5.08219117 L4.28393801,197.5 L221.716062,197.5 L113,5.08219117 Z\" />\n        </g>\n      </svg>\n    </div>\n  `\n\n  return container\n}\n\nfunction createCss(prefix) {\n  const css = document.createElement('style')\n  css.textContent = `\n    #${prefix}container {\n      position: absolute;\n      bottom: 10px;\n      right: 30px;\n\n      border-radius: 3px;\n      background: #000;\n      color: #fff;\n      font: initial;\n      cursor: initial;\n      letter-spacing: initial;\n      text-shadow: initial;\n      text-transform: initial;\n      visibility: initial;\n\n      padding: 7px 10px 8px 10px;\n      align-items: center;\n      box-shadow: 0 11px 40px 0 rgba(0, 0, 0, 0.25), 0 2px 10px 0 rgba(0, 0, 0, 0.12);\n\n      display: none;\n      opacity: 0;\n      transition: opacity 0.1s ease, bottom 0.1s ease;\n      animation: ${prefix}fade-in 0.1s ease-in-out;\n    }\n\n    #${prefix}container.${prefix}visible {\n      display: flex;\n    }\n\n    #${prefix}container.${prefix}building {\n      bottom: 20px;\n      opacity: 1;\n    }\n\n    #${prefix}icon-wrapper {\n      width: 16px;\n      height: 16px;\n    }\n\n    #${prefix}icon-wrapper > svg {\n      width: 100%;\n      height: 100%;\n    }\n\n    #${prefix}icon-group {\n      animation: ${prefix}strokedash 1s ease-in-out both infinite;\n    }\n\n    @keyframes ${prefix}fade-in {\n      from {\n        bottom: 10px;\n        opacity: 0;\n      }\n      to {\n        bottom: 20px;\n        opacity: 1;\n      }\n    }\n\n    @keyframes ${prefix}strokedash {\n      0% {\n        stroke-dasharray: 0 226;\n      }\n      80%,\n      100% {\n        stroke-dasharray: 659 226;\n      }\n    }\n  `\n\n  return css\n}\n"]},"metadata":{},"sourceType":"script"}